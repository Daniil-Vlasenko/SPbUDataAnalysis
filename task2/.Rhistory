ggpairs(diag=list(continuous = "barDiag"), aes(colour=EXP_IND), legend=1,
columns=c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"), aes(colour=DANG_IND), legend=1,
columns=c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
library(lm.beta)
dfNew.num <- dfNew %>% dplyr::select(-NAME) %>%
mutate(PRED_IND=as.numeric(PRED_IND), EXP_IND=as.numeric(EXP_IND), DANG_IND=as.numeric(DANG_IND))
model1 = lm(LIFESPAN~., data=dfNew.num, na.action="na.exclude")
summary(model1)
# residuals.lm(model)
alias(model1)
cor(x=dfNew.num %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
model1 = lm(LIFESPAN~BODY_WEI+BRAIN_WE+SLOWWAVE+PARADOX+GESTTIME+PRED_IND+EXP_IND+DANG_IND, data=dfNew.num, na.action="na.exclude")
model1.beta <- lm.beta(model1)
summary(model1.beta)
cov2cor(vcov(model1))
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
library(olsrr)
ols_vif_tol(model1)
ols_correlations(model1)
model2 = lm(LIFESPAN~BODY_WEI+BRAIN_WE+SLOWWAVE+PARADOX+GESTTIME+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model2.beta <- lm.beta(model2)
summary(model2.beta)
ols_vif_tol(model2)
ols_correlations(model2)
model3 = lm(LIFESPAN~BRAIN_WE+SLOWWAVE+PARADOX+GESTTIME+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model3.beta <- lm.beta(model3)
summary(model3.beta)
ols_vif_tol(model3)
ols_correlations(model2)
model4 = lm(LIFESPAN~SLOWWAVE+PARADOX+GESTTIME+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model4.beta <- lm.beta(model4)
summary(model4.beta)
library(MASS)
model1.AIC <- lm(LIFESPAN~BODY_WEI+BRAIN_WE+SLOWWAVE+PARADOX+GESTTIME+PRED_IND+EXP_IND+DANG_IND,
data=na.omit(dfNew.num))
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN~1, data=na.omit(dfNew.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model.AIC, direction="both")
model.AIC = lm(LIFESPAN~BRAIN_WE+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.exclude")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
residuals.lm(model.AIC.beta)
residuals(model.AIC.beta)
residuals(model.AIC.beta)
plot(fitted(model.AIC.beta), res)
fitted(model.AIC.beta)
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE", "SLOWWAVE", "PARADOX", "EXP_IND"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME),
SLOWWAVE.log = log(SLOWWAVE), PARADOX.log = log(PARADOX),
SLEEP.log = log(SLEEP))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
nrow(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
repeat_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
(length(x) - length(u)) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
df %>% summarise(BODY_WEI = round(repeat_rate(BODY_WEI), 3), BRAIN_WE = round(repeat_rate(BRAIN_WE), 3),
SLOWWAVE = round(repeat_rate(SLOWWAVE), 3), PARADOX = round(repeat_rate(PARADOX), 3),
SLEEP = round(repeat_rate(SLEEP), 3), LIFESPAN = round(repeat_rate(LIFESPAN), 3),
GESTTIME = round(repeat_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
library(lm.beta)
dfNew.num <- dfNew %>% dplyr::select(-NAME) %>%
mutate(PRED_IND=as.numeric(PRED_IND), EXP_IND=as.numeric(EXP_IND), DANG_IND=as.numeric(DANG_IND))
model1 = lm(LIFESPAN.log~., data=dfNew.num, na.action="na.exclude")
summary(model1)
alias(model1)
cor(x=dfNew.num %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
model1 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND, data=dfNew.num, na.action="na.exclude")
model1.beta <- lm.beta(model1)
summary(model1.beta)
cov2cor(vcov(model1))
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
library(olsrr)
ols_vif_tol(model1)
ols_correlations(model1)
model2 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model2.beta <- lm.beta(model2)
summary(model2.beta)
ols_vif_tol(model2)
ols_correlations(model2)
model3 = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model3.beta <- lm.beta(model3)
summary(model3.beta)
ols_vif_tol(model3)
ols_correlations(model2)
model4 = lm(LIFESPAN.log~SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model4.beta <- lm.beta(model4)
summary(model4.beta)
library(MASS)
model1.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=na.omit(dfNew.num))
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN.log~1, data=na.omit(dfNew.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model.AIC, direction="both")
model.AIC = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.exclude")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE.log", "SLOWWAVE", "PARADOX", "EXP_IND"))
residuals(model.AIC.beta)
plot(fitted(model.AIC.beta), res)
plot(fitted(model.AIC.beta), residuals(model.AIC.beta))
fitted(model.AIC.beta)
plot(fitted(model.AIC.beta), residuals(model.AIC.beta) - dfNew.num$LIFESPAN)
fitted(model.AIC.beta)
plot(fitted(model.AIC.beta), residuals(model.AIC.beta))
fitted(model.AIC.beta)
plot(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
df <- data_frame(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
df
df <- data_frame(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=values, y=residuals)) +
geom_point()
df <- data_frame(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=fitted.values, y=residuals)) +
geom_point()
# plot(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
# fitted(model.AIC.beta)
df <- data_frame(fitted.values=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=fitted.values, y=residuals)) +
geom_point()
df <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=predicted, y=residuals)) +
geom_point()
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE.log", "SLOWWAVE", "PARADOX", "EXP_IND"))
install.packages("olsrr")
install.packages("olsrr")
library(olsrr)
ols_plot_resid_stud_fit(model.AIC.beta)
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
nrow(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
repeat_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
(length(x) - length(u)) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
df %>% summarise(BODY_WEI = round(repeat_rate(BODY_WEI), 3), BRAIN_WE = round(repeat_rate(BRAIN_WE), 3),
SLOWWAVE = round(repeat_rate(SLOWWAVE), 3), PARADOX = round(repeat_rate(PARADOX), 3),
SLEEP = round(repeat_rate(SLEEP), 3), LIFESPAN = round(repeat_rate(LIFESPAN), 3),
GESTTIME = round(repeat_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
library(lm.beta)
dfNew.num <- dfNew %>% dplyr::select(-NAME) %>%
mutate(PRED_IND=as.numeric(PRED_IND), EXP_IND=as.numeric(EXP_IND), DANG_IND=as.numeric(DANG_IND))
model1 = lm(LIFESPAN.log~., data=dfNew.num, na.action="na.exclude")
summary(model1)
alias(model1)
cor(x=dfNew.num %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
model1 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND, data=dfNew.num, na.action="na.exclude")
model1.beta <- lm.beta(model1)
summary(model1.beta)
cov2cor(vcov(model1))
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
library(olsrr)
ols_vif_tol(model1)
ols_correlations(model1)
model2 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model2.beta <- lm.beta(model2)
summary(model2.beta)
ols_vif_tol(model2)
ols_correlations(model2)
model3 = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model3.beta <- lm.beta(model3)
summary(model3.beta)
ols_vif_tol(model3)
ols_correlations(model2)
model4 = lm(LIFESPAN.log~SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model4.beta <- lm.beta(model4)
summary(model4.beta)
library(MASS)
model1.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=na.omit(dfNew.num))
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN.log~1, data=na.omit(dfNew.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model.AIC, direction="both")
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE.log", "SLOWWAVE", "PARADOX", "EXP_IND"))
model.AIC = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.exclude")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
df <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=predicted, y=residuals)) +
geom_point()
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
model.AIC = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.omit")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
df <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df, aes(x=predicted, y=residuals)) +
geom_point()
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC)
tmp
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC)
tmp$outliers
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC)
class(tmp)
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC, print_plot = FALSE)
class(tmp)
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC, print_plot=FALSE)
ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
class(tmp)
library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC, print_plot=FALSE)
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp$outliers
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp$outliers
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=predicted, y=residuals)) +
geom_point()
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
studres(model)
studres=studres(model.AIC)
studres(model.AIC)
df
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
df
df.fr <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df.fr, aes(x=predicted, y=residuals)) +
geom_point()
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
df.fr
df.rs
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
geom_abline(slope=1)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
geom_abline(slope=1, intercept=0)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point() +
geom_abline(slope=1, intercept=0)
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
stepAIC(model.AIC, direction="both")
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
nrow(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
repeat_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
(length(x) - length(u)) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
df %>% summarise(BODY_WEI = round(repeat_rate(BODY_WEI), 3), BRAIN_WE = round(repeat_rate(BRAIN_WE), 3),
SLOWWAVE = round(repeat_rate(SLOWWAVE), 3), PARADOX = round(repeat_rate(PARADOX), 3),
SLEEP = round(repeat_rate(SLEEP), 3), LIFESPAN = round(repeat_rate(LIFESPAN), 3),
GESTTIME = round(repeat_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
library(lm.beta)
dfNew.num <- dfNew %>% dplyr::select(-NAME) %>%
mutate(PRED_IND=as.numeric(PRED_IND), EXP_IND=as.numeric(EXP_IND), DANG_IND=as.numeric(DANG_IND))
model1 = lm(LIFESPAN.log~., data=dfNew.num, na.action="na.exclude")
summary(model1)
alias(model1)
cor(x=dfNew.num %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
model1 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND, data=dfNew.num, na.action="na.exclude")
model1.beta <- lm.beta(model1)
summary(model1.beta)
cov2cor(vcov(model1))
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
library(olsrr)
ols_vif_tol(model1)
ols_correlations(model1)
model2 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model2.beta <- lm.beta(model2)
summary(model2.beta)
ols_vif_tol(model2)
ols_correlations(model2)
model3 = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model3.beta <- lm.beta(model3)
summary(model3.beta)
ols_vif_tol(model3)
ols_correlations(model2)
model4 = lm(LIFESPAN.log~SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model4.beta <- lm.beta(model4)
summary(model4.beta)
library(MASS)
model1.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=na.omit(dfNew.num))
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN.log~1, data=na.omit(dfNew.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model.AIC, direction="both")
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE.log", "SLOWWAVE", "PARADOX", "EXP_IND"))
model.AIC = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.omit")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
df.fr <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df.fr, aes(x=predicted, y=residuals)) +
geom_point()
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point() +
geom_abline(slope=1, intercept=0)
