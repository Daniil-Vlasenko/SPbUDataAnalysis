library(olsrr)
tmp <- ols_plot_resid_stud_fit(model.AIC, print_plot=FALSE)
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp$outliers
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp$outliers
# ols_plot_resid_stud_fit(model.AIC, print_plot=TRUE)
tmp
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=predicted, y=residuals)) +
geom_point()
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
studres(model)
studres=studres(model.AIC)
studres(model.AIC)
df
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
df <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df, aes(x=residuals, y=studres)) +
geom_point()
df
df.fr <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df.fr, aes(x=predicted, y=residuals)) +
geom_point()
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
df.fr
df.rs
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
geom_abline(slope=1)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point()
geom_abline(slope=1, intercept=0)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point() +
geom_abline(slope=1, intercept=0)
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
stepAIC(model.AIC, direction="both")
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
nrow(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
repeat_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
(length(x) - length(u)) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
df %>% summarise(BODY_WEI = round(repeat_rate(BODY_WEI), 3), BRAIN_WE = round(repeat_rate(BRAIN_WE), 3),
SLOWWAVE = round(repeat_rate(SLOWWAVE), 3), PARADOX = round(repeat_rate(PARADOX), 3),
SLEEP = round(repeat_rate(SLEEP), 3), LIFESPAN = round(repeat_rate(LIFESPAN), 3),
GESTTIME = round(repeat_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>% mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
library(lm.beta)
dfNew.num <- dfNew %>% dplyr::select(-NAME) %>%
mutate(PRED_IND=as.numeric(PRED_IND), EXP_IND=as.numeric(EXP_IND), DANG_IND=as.numeric(DANG_IND))
model1 = lm(LIFESPAN.log~., data=dfNew.num, na.action="na.exclude")
summary(model1)
alias(model1)
cor(x=dfNew.num %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
model1 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND, data=dfNew.num, na.action="na.exclude")
model1.beta <- lm.beta(model1)
summary(model1.beta)
cov2cor(vcov(model1))
library(DescTools)
tmp <- data_frame(SLOWWAV=c(0.27819), PRED_IND=c(-0.54334))
plot(tmp)
DrawEllipse(x=0.27819, y=-0.54334, radius.x=0.07, radius.y=0.03, rot=acos(-0.54334))
library(olsrr)
ols_vif_tol(model1)
ols_correlations(model1)
model2 = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model2.beta <- lm.beta(model2)
summary(model2.beta)
ols_vif_tol(model2)
ols_correlations(model2)
model3 = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model3.beta <- lm.beta(model3)
summary(model3.beta)
ols_vif_tol(model3)
ols_correlations(model2)
model4 = lm(LIFESPAN.log~SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND,
data=dfNew.num, na.action="na.exclude")
model4.beta <- lm.beta(model4)
summary(model4.beta)
library(MASS)
model1.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLOWWAVE+PARADOX+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=na.omit(dfNew.num))
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN.log~1, data=na.omit(dfNew.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model.AIC, direction="both")
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BRAIN_WE.log", "SLOWWAVE", "PARADOX", "EXP_IND"))
model.AIC = lm(LIFESPAN.log~BRAIN_WE.log+SLOWWAVE+PARADOX+EXP_IND, data=dfNew.num, na.action="na.omit")
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
df.fr <- data_frame(predicted=fitted(model.AIC.beta), residuals=residuals(model.AIC.beta))
ggplot(df.fr, aes(x=predicted, y=residuals)) +
geom_point()
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point() +
geom_abline(slope=1, intercept=0)
dfNew.o.num[c(6,14,22,27,49),]$NAME
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>%
mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
dfNew.num <- dfNew %>%
mutate(PRED_IND = as.numeric(PRED_IND), EXP_IND = as.numeric(EXP_IND),
DANG_IND = as.numeric(DANG_IND))
cor(x=dfNew.num %>% dplyr::select(-NAME) %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
dfNew.o.dum <- dfNew %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
dfNew.o.num <- dfNew.num %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
c(nrow(dfNew), nrow(dfNew.o.num))
dfNew.o.num %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(lm.beta)
model1.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model1.num.beta <- lm.beta(model1.num)
summary(model1.num.beta)
model1.dum = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.dum)
model1.dum.beta <- lm.beta(model1.dum)
summary(model1.dum.beta)
library(olsrr)
ols_vif_tol(model1.num)
ols_correlations(model1.num)
model2.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model2.num.beta <- lm.beta(model2.num)
summary(model2.num.beta)
ols_vif_tol(model2.num)
ols_correlations(model2.num)
model3.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND,
data=dfNew.o.num)
model3.num.beta <- lm.beta(model3.num)
summary(model3.num.beta)
ols_vif_tol(model3.num)
ols_correlations(model3.num)
model4.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model4.num.beta <- lm.beta(model4.num)
summary(model4.num.beta)
ols_vif_tol(model4.num)
ols_correlations(model4.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
ols_vif_tol(model5.num)
ols_correlations(model5.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(MASS)
model1.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
stepAIC(model1.AIC, direction="backward")
model2.AIC <- lm(LIFESPAN.log~1, data=na.omit(dfNew.o.num))
stepAIC(model2.AIC, direction="forward", scope=list(upper=model1.AIC,lower=model2.AIC))
stepAIC(model1.AIC, direction="both")
dfNew.o.num %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLEEP"))
dfNew.o.num %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("PRED_IND", "EXP_IND", "DANG_IND"))
model.AIC <- lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model.AIC.beta <- lm.beta(model.AIC)
summary(model.AIC.beta)
shapiro.test(residuals(model.AIC.beta))
library(olsrr)
ols_plot_resid_stud_fit(model.AIC)
ols_plot_resid_stud(model.AIC)
dfNew.o.num[c(6,14,22,27,49),]$NAME
dfNew.o.num[c(6,14,22,27,49),]
df.rs <- data_frame(residuals=residuals(model.AIC), studres=studres(model.AIC))
ggplot(df.rs, aes(x=residuals, y=studres)) +
geom_point() +
geom_abline(slope=1, intercept=0, color='#E41A1C') +
geom_smooth(method='lm')
library(rstatix)
mahal <- dfNew.o.num %>%
dplyr::select(-NAME) %>%
mahalanobis_distance()
plot(mahal$mahal.dist)
library(car)
plot(cooks.distance(model.AIC))
tail(sort(mahal$mahal.dist),5)
mahal %>% dplyr::select(mahal.dist == tail(sort(mahal.dist),5))
mahal %>% dplyr::filter(mahal.dist == tail(sort(mahal.dist),5))
tail(sort(mahal$mahal.dist),5)
mahal %>% dplyr::filter(mahal.dist == tail(sort(mahal.dist),5))
mahal.dist == tail(sort(mahal.dist),5)
mahal$mahal.dist == tail(sort(mahal.dist),5)
mahal$mahal.dist == tail(sort(mahal.dist),5)
mahal
mahal$mahal.dist
mahal$mahal.dist == tail(sort(mahal.dist),5)
mahal$mahal.dist == tail(sort(mahal$mahal.dist),5)
mahal$mahal.dist %in% tail(sort(mahal$mahal.dist),5)
dfNew.o.num[mahal$mahal.dist %in% tail(sort(mahal$mahal.dist),5),]
dfNew.o.num[mahal$mahal.dist %in% tail(sort(mahal$mahal.dist),5),]
cook <- cooks.distance(model.AIC)
plot(cook)
dfNew.o.num[cook %in% tail(sort(cook),5),]
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95, vcov. = function(x) cov2cor(vcov(x))), type="l")
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>%
mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
dfNew.num <- dfNew %>%
mutate(PRED_IND = as.numeric(PRED_IND), EXP_IND = as.numeric(EXP_IND),
DANG_IND = as.numeric(DANG_IND))
cor(x=dfNew.num %>% dplyr::select(-NAME) %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
dfNew.o.dum <- dfNew %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
dfNew.o.num <- dfNew.num %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
c(nrow(dfNew), nrow(dfNew.o.num))
dfNew.o.num %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(lm.beta)
model1.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model1.num.beta <- lm.beta(model1.num)
summary(model1.num.beta)
model1.dum = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.dum)
model1.dum.beta <- lm.beta(model1.dum)
summary(model1.dum.beta)
library(olsrr)
ols_vif_tol(model1.num)
ols_correlations(model1.num)
model2.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model2.num.beta <- lm.beta(model2.num)
summary(model2.num.beta)
ols_vif_tol(model2.num)
ols_correlations(model2.num)
model3.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND,
data=dfNew.o.num)
model3.num.beta <- lm.beta(model3.num)
summary(model3.num.beta)
ols_vif_tol(model3.num)
ols_correlations(model3.num)
model4.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model4.num.beta <- lm.beta(model4.num)
summary(model4.num.beta)
ols_vif_tol(model4.num)
ols_correlations(model4.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
ols_vif_tol(model5.num)
ols_correlations(model5.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95, vcov. = function(x) cov2cor(vcov(x))), type="l")
library(ellipse)
plot(confidence.ellipse(model5.num, which = c(2, 3), level = 0.95, vcov. = function(x) cov2cor(vcov(x))), type="l")
library(ellipse)
plot(confidenceEllipse(model5.num, which = c(2, 3), level = 0.95, vcov. = function(x) cov2cor(vcov(x))), type="l")
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
plot(confidenceEllipse(model5.num, which = c(2, 3), level = 0.95, vcov. = function(x) cov2cor(vcov(x))), type="l")
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
library(readxl)
library(dplyr)
library(tidyr)
df <- read_excel("Sleep/SLEEP_shortname.xls")
df[df < 0] <- NA
head(df)
mode_rate <- function(x) {
x <- x[!is.na(x)]
u <- unique(x)
tab <- tabulate(match(x, u))
max(tab) / length(x)
}
df %>% summarise(BODY_WEI = round(mode_rate(BODY_WEI), 3), BRAIN_WE = round(mode_rate(BRAIN_WE), 3),
SLOWWAVE = round(mode_rate(SLOWWAVE), 3), PARADOX = round(mode_rate(PARADOX), 3),
SLEEP = round(mode_rate(SLEEP), 3), LIFESPAN = round(mode_rate(LIFESPAN), 3),
GESTTIME = round(mode_rate(GESTTIME), 3))
library(ggplot2)
library(GGally)
df %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI", "BRAIN_WE", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN", "GESTTIME"))
dfNew <- df %>%
mutate(PRED_IND = as.factor(PRED_IND), EXP_IND = as.factor(EXP_IND),
DANG_IND = as.factor(DANG_IND),
BODY_WEI.log = log(BODY_WEI), BRAIN_WE.log = log(BRAIN_WE),
LIFESPAN.log = log(LIFESPAN), GESTTIME.log = log(GESTTIME))
dfNew %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLOWWAVE", "PARADOX", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(moments)
characteristics <- function(x) {
c(mean = round(mean(x, na.rm = TRUE), 3),
median = round(median(x, na.rm = TRUE), 3),
var = round(var(x, na.rm = TRUE), 3),
skewness = round(skewness(x, na.rm = TRUE), 3),
kurtosis = round(kurtosis(x, na.rm = TRUE) - 3, 3))
}
data.frame(lapply(as.list(dfNew[2:8]), characteristics)) %>% t()
dfNew.num <- dfNew %>%
mutate(PRED_IND = as.numeric(PRED_IND), EXP_IND = as.numeric(EXP_IND),
DANG_IND = as.numeric(DANG_IND))
cor(x=dfNew.num %>% dplyr::select(-NAME) %>%
mutate(SLOWWAVE_PARADOX=SLOWWAVE+PARADOX),
use="pairwise.complete.obs")
dfNew.o.dum <- dfNew %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
dfNew.o.num <- dfNew.num %>% dplyr::select(-SLOWWAVE, -PARADOX) %>% na.omit()
c(nrow(dfNew), nrow(dfNew.o.num))
dfNew.o.num %>% dplyr::select(-NAME) %>%
ggpairs(diag=list(continuous = "barDiag"),
columns = c("BODY_WEI.log", "BRAIN_WE.log", "SLEEP", "LIFESPAN.log", "GESTTIME.log"))
library(lm.beta)
model1.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model1.num.beta <- lm.beta(model1.num)
summary(model1.num.beta)
model1.dum = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+GESTTIME.log+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.dum)
model1.dum.beta <- lm.beta(model1.dum)
summary(model1.dum.beta)
library(olsrr)
ols_vif_tol(model1.num)
ols_correlations(model1.num)
model2.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND+DANG_IND,
data=dfNew.o.num)
model2.num.beta <- lm.beta(model2.num)
summary(model2.num.beta)
ols_vif_tol(model2.num)
ols_correlations(model2.num)
model3.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+SLEEP+PRED_IND+EXP_IND,
data=dfNew.o.num)
model3.num.beta <- lm.beta(model3.num)
summary(model3.num.beta)
ols_vif_tol(model3.num)
ols_correlations(model3.num)
model4.num = lm(LIFESPAN.log~BODY_WEI.log+BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model4.num.beta <- lm.beta(model4.num)
summary(model4.num.beta)
ols_vif_tol(model4.num)
ols_correlations(model4.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND+EXP_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
ols_vif_tol(model5.num)
ols_correlations(model5.num)
model5.num = lm(LIFESPAN.log~BRAIN_WE.log+PRED_IND,
data=dfNew.o.num)
model5.num.beta <- lm.beta(model5.num)
summary(model5.num.beta)
library(ellipse)
plot(ellipse(model5.num, which = c(2, 3), level = 0.95), type="l")
ellipse(model5.num, which = c(2, 3), level = 0.95)
model5.num
dfNew.o.num[mahal$mahal.dist %in% tail(sort(mahal$mahal.dist),5),]$NAME
dfNew.o.num[mahal$mahal.dist %in% tail(sort(mahal$mahal.dist),5),]
dfNew.o.num[cook %in% tail(sort(cook),5),]$NAME
dfNew.o.num[cook %in% tail(sort(cook),5),]
